local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- Inicializa a tabela global
getgenv().PudimESP = getgenv().PudimESP or {}

-- Criação da interface principal
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PudimHub"
screenGui.ResetOnSpawn = false
screenGui.Parent = game:GetService("CoreGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 260)
frame.Position = UDim2.new(0, 20, 0.5, -130)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Parent = screenGui

-- Minimizar / Mostrar conteúdo
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(1, 0, 0, 30)
toggleButton.Position = UDim2.new(0, 0, 0, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Text = "Pudim Hub"
toggleButton.Font = Enum.Font.SourceSansBold
toggleButton.TextSize = 20
toggleButton.Parent = frame

local contentVisible = true
local function toggleContent()
    contentVisible = not contentVisible
    for _, child in pairs(frame:GetChildren()) do
        if child:IsA("TextButton") and child ~= toggleButton then
            child.Visible = contentVisible
        end
    end
end
toggleButton.MouseButton1Click:Connect(toggleContent)

-- ESP
local espButton = Instance.new("TextButton")
espButton.Size = UDim2.new(0.8, 0, 0, 40)
espButton.Position = UDim2.new(0.1, 0, 0, 40)
espButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
espButton.TextColor3 = Color3.new(1, 1, 1)
espButton.Text = getgenv().PudimESP.esp and "Desativar ESP" or "Ativar ESP"
espButton.Font = Enum.Font.SourceSansBold
espButton.TextSize = 18
espButton.Visible = contentVisible
espButton.Parent = frame

getgenv().PudimESP.esp = getgenv().PudimESP.esp or false
local function toggleESP()
    getgenv().PudimESP.esp = not getgenv().PudimESP.esp
    espButton.Text = getgenv().PudimESP.esp and "Desativar ESP" or "Ativar ESP"
end
espButton.MouseButton1Click:Connect(toggleESP)

RunService.RenderStepped:Connect(function()
    if not getgenv().PudimESP.esp then return end
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            for _, part in ipairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Material = Enum.Material.Neon
                    part.Color = Color3.new(1, 0, 0)
                end
            end
        end
    end
end)

-- Pulo 2x
local jumpButton = Instance.new("TextButton")
jumpButton.Size = UDim2.new(0.8, 0, 0, 40)
jumpButton.Position = UDim2.new(0.1, 0, 0, 95)
jumpButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
jumpButton.TextColor3 = Color3.new(1, 1, 1)
jumpButton.Text = getgenv().PudimESP.doubleJump and "Desativar Pulo 2x" or "Ativar Pulo 2x"
jumpButton.Font = Enum.Font.SourceSansBold
jumpButton.TextSize = 18
jumpButton.Visible = contentVisible
jumpButton.Parent = frame

getgenv().PudimESP.doubleJump = getgenv().PudimESP.doubleJump or false
local originalJumpPower = nil

local function toggleDoubleJump()
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end

    if not getgenv().PudimESP.doubleJump then
        originalJumpPower = humanoid.JumpPower
        humanoid.UseJumpPower = true
        humanoid.JumpPower = originalJumpPower * 2
        jumpButton.Text = "Desativar Pulo 2x"
    else
        humanoid.JumpPower = originalJumpPower or 50
        jumpButton.Text = "Ativar Pulo 2x"
    end

    getgenv().PudimESP.doubleJump = not getgenv().PudimESP.doubleJump
end
jumpButton.MouseButton1Click:Connect(toggleDoubleJump)

-- Noclip
local noclipButton = Instance.new("TextButton")
noclipButton.Size = UDim2.new(0.8, 0, 0, 40)
noclipButton.Position = UDim2.new(0.1, 0, 0, 145)
noclipButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
noclipButton.TextColor3 = Color3.new(1, 1, 1)
noclipButton.Text = getgenv().PudimESP.noclip and "Desativar Noclip" or "Ativar Noclip"
noclipButton.Font = Enum.Font.SourceSansBold
noclipButton.TextSize = 18
noclipButton.Visible = contentVisible
noclipButton.Parent = frame

getgenv().PudimESP.noclip = getgenv().PudimESP.noclip or false
local function toggleNoclip()
    getgenv().PudimESP.noclip = not getgenv().PudimESP.noclip
    noclipButton.Text = getgenv().PudimESP.noclip and "Desativar Noclip" or "Ativar Noclip"
end
noclipButton.MouseButton1Click:Connect(toggleNoclip)

RunService.Stepped:Connect(function()
    if getgenv().PudimESP.noclip and LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- Fly
local flyButton = Instance.new("TextButton")
flyButton.Size = UDim2.new(0.8, 0, 0, 40)
flyButton.Position = UDim2.new(0.1, 0, 0, 190)
flyButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
flyButton.TextColor3 = Color3.new(1, 1, 1)
flyButton.Text = getgenv().PudimESP.fly and "Desativar Fly" or "Ativar Fly"
flyButton.Font = Enum.Font.SourceSansBold
flyButton.TextSize = 18
flyButton.Visible = contentVisible
flyButton.Parent = frame

getgenv().PudimESP.fly = getgenv().PudimESP.fly or false
local flyBV, flyConn
local speed = 50

local function toggleFly()
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")

    getgenv().PudimESP.fly = not getgenv().PudimESP.fly
    flyButton.Text = getgenv().PudimESP.fly and "Desativar Fly" or "Ativar Fly"

    if getgenv().PudimESP.fly then
        flyBV = Instance.new("BodyVelocity")
        flyBV.Velocity = Vector3.zero
        flyBV.MaxForce = Vector3.new(1e5, 1e5, 1e5)
        flyBV.P = 1250
        flyBV.Parent = hrp

        flyConn = RunService.RenderStepped:Connect(function()
            local cam = workspace.CurrentCamera
            local moveVec = Vector3.zero
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveVec += cam.CFrame.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveVec -= cam.CFrame.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveVec -= cam.CFrame.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveVec += cam.CFrame.RightVector end
            flyBV.Velocity = moveVec.Magnitude > 0 and moveVec.Unit * speed or Vector3.zero
        end)
    else
        if flyBV then flyBV:Destroy() flyBV = nil end
        if flyConn then flyConn:Disconnect() flyConn = nil end
    end
end
flyButton.MouseButton1Click:Connect(toggleFly)
